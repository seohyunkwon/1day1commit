SELECT FLAVOR FROM (SELECT * FROM FIRST_HALF WHERE TOTAL_ORDER>3000) A
WHERE FLAVOR IN (SELECT FLAVOR FROM ICECREAM_INFO WHERE INGREDIENT_TYPE = 'fruit_based'
)